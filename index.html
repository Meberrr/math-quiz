<!DOCTYPE html>
<html lang="zh-Hant">
<head>
<meta charset="UTF-8">
<title>æ•¸å­¸å‰å¾Œæ¸¬å•å·</title>
<style>
  body { font-family: "Microsoft JhengHei"; margin: 40px; background-color: #f9f9f9; }
  h2 { color: #2a4d8f; }
  input, select { padding: 6px; margin: 6px; }
  button { padding: 10px 20px; background-color: #4CAF50; color: white; border: none; cursor: pointer; }
  button:hover { background-color: #45a049; }
</style>
</head>
<script src="Test_js.js"></script>
<body>

<h2>æ•¸å­¸å‰å¾Œæ¸¬å•å·</h2>

<p><strong>è‡ªè¨‚ä»£è™Ÿ(å…±å››ç¢¼)/strong> ç”Ÿæ—¥æœˆä»½ + åº§è™Ÿï¼ˆä¾‹å¦‚ï¼š7æœˆ3è™Ÿ â†’ 0703ï¼‰</p>
<select id="classSelect">
  <option value="Aç­">Aç­</option>
  <option value="Bç­">Bç­</option>
  <option value="Cç­">Cç­</option>
</select>
<input type="text" id="studentId" placeholder="è«‹è¼¸å…¥è‡ªè¨‚ä»£è™Ÿ(å››ç¢¼)>

<form id="quizForm">
  <ol>
    <li>11 + 27 = <input type="number" id="Q1"></li>
    <li>2 Ã— 12 Ã— 19 = <input type="number" id="Q2"></li>
    <li>24 Ã— 3 Ã— 11 = <input type="number" id="Q3"></li>
    <li>32 Ã· 4 + 4 = <input type="number" id="Q4"></li>
    <li>15 Ã· 3 Ã— 23 = <input type="number" id="Q5"></li>
    <li>9 Ã— 6 Ã· 27 = <input type="number" id="Q6"></li>
    <li>15 Ã— (30 - 13) = <input type="number" id="Q7"></li>
    <li>21 Ã— (27 Ã· 3) = <input type="number" id="Q8"></li>
    <li>(30 - 14) Ã· 4 = <input type="number" id="Q9"></li>
  </ol>
  <button type="button" id="submitBtn">é€å‡ºç­”æ¡ˆ</button>
</form>

<p id="result"></p>

<script>
const startTime = Date.now();
const scriptURL = "ğŸ”¹åœ¨é€™è£¡è²¼ä¸Šä½ çš„ Google Apps Script ç¶²å€ğŸ”¹";

document.getElementById("submitBtn").addEventListener("click", () => {
  const endTime = Date.now();
  const timeSpent = ((endTime - startTime) / 1000).toFixed(2);
  const studentId = document.getElementById("studentId").value.trim();
  const className = document.getElementById("classSelect").value;
  if (!studentId) return alert("è«‹è¼¸å…¥ä»£è™Ÿï¼");

  const answers = {
    Q1: +document.getElementById("Q1").value,
    Q2: +document.getElementById("Q2").value,
    Q3: +document.getElementById("Q3").value,
    Q4: +document.getElementById("Q4").value,
    Q5: +document.getElementById("Q5").value,
    Q6: +document.getElementById("Q6").value,
    Q7: +document.getElementById("Q7").value,
    Q8: +document.getElementById("Q8").value,
    Q9: +document.getElementById("Q9").value
  };

  const correctAnswers = {Q1:38, Q2:456, Q3:792, Q4:12, Q5:115, Q6:2, Q7:255, Q8:189, Q9:4};
  let score = 0;
  for (let key in answers) {
    if (answers[key] === correctAnswers[key]) score++;
  }

  const data = {
    class: className,
    studentId: studentId,
    ...answers,
    score: score,
    timeSpent: timeSpent
  };

  fetch(scriptURL, {
    method: "POST",
    body: JSON.stringify(data)
  })
  .then(res => res.text())
  .then(() => {
    document.getElementById("result").innerHTML =
      `<strong>å·²é€å‡ºï¼</strong><br>ç­”å°ï¼š${score}/9 é¡Œ<br>ä½œç­”æ™‚é–“ï¼š${timeSpent} ç§’`;
  })
  .catch(err => alert("è³‡æ–™å‚³é€å¤±æ•—ï¼š" + err));
});
</script>

</body>
</html>


